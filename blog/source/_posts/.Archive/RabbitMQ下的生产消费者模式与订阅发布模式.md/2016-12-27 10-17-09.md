---
title: RabbitMQ下的生产消费者模式与订阅发布模式
date: 2016-12-27 10:08:09
tags: [RabbitMQ,大数据,MQ]
categories: [技术积累]
---
# 前言
生产消费者模式与订阅发布模式是使用消息中间件时常用的两种模式，用于功能解耦和分布式系统间的消息通信。
## 数据接入
一个用户行为采集系统，负责从App端采集用户点击行为数据。通常会将数据上报和数据处理分离开，即App端通过REST API上报数据，后端拿到数据后放入队列中就立刻返回，而数据处理则另外使用Worker从队列中取出数据来做，如下图所示：
这样做的好处有：第一，功能分离，上报的API接口不关心数据处理功能，只负责接入数据；第二，数据缓冲，数据上报的速率是不可控的，取决于用户使用频率，采用该模式可以一定程度地缓冲数据；第三，易于扩展，在数据量大时，通过增加数据处理Worker来扩展，提高处理速率。这便是典型的生产消费者模式，数据上报为生产者，数据处理为消费者。
## 事件分发

# RabbitMQ核心概念
## 通信方式
## 消息体
## 消息投递
## 消息可靠性
# 生产消费者模式
# 生产消费者模式
![](http://www.itdadao.com/articles/c15a901095p0.html)
